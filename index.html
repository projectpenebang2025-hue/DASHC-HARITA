<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Form Daily Input Ritase ‚Äì Offline</title>
<meta name="theme-color" content="#0f172a">
<link rel="manifest" href="manifest.json" />
<!-- Font elegan untuk nama perusahaan -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
/* ==== CSS (tidak dihapus apapun) ==== */
:root{
  --bg:#0f172a;
  --card:rgba(17,24,39,0.7);
  --muted:#94a3b8;
  --text:#e5e7eb;
  --accent:#22c55e;
  --accent-2:#38bdf8;
  --danger:#ef4444;
  --warning:#f59e0b;
  --border:rgba(255,255,255,0.08);
  --shadow:0 8px 25px rgba(0,0,0,0.35);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:linear-gradient(160deg,#0b1020,#0f172a 60%,#111827);
  color:var(--text);
  font:16px/1.5 "Inter",system-ui,Segoe UI,Roboto,Arial;
}
.container{max-width:1100px;margin:24px auto;padding:16px}
.grid{display:grid;gap:16px}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:20px;
  backdrop-filter:blur(12px) saturate(160%);
  box-shadow:0 8px 25px rgba(0,0,0,0.35);
  transition:transform .2s ease,box-shadow .3s ease;
}
.card:hover{transform:translateY(-4px);box-shadow:0 12px 32px rgba(0,0,0,.45)}
h1{font-size:24px;margin:0 0 10px;font-weight:600}
h2{font-size:18px;margin:0 0 14px;color:var(--muted);font-weight:500}
label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
input,select,button{
  width:100%;padding:10px 12px;border-radius:12px;
  border:1px solid var(--border);background:#0b1222;color:var(--text);
  transition:all .2s ease;
}
input[type=number]{appearance:textfield}
input:focus,select:focus{
  outline:none;
  border-color:var(--accent-2);
  box-shadow:0 0 0 2px rgba(56,189,248,.4);
}
.row{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
.col-3{grid-column:span 3}
.col-4{grid-column:span 4}
.col-6{grid-column:span 6}
.col-8{grid-column:span 8}
.col-12{grid-column:span 12}
.actions{display:flex;gap:10px;flex-wrap:wrap}
.btn{
  cursor:pointer;border:none;font-weight:600;
  padding:10px 16px;border-radius:12px;transition:all .2s ease;
}
.btn.primary{background:var(--accent);color:#052e16}
.btn.primary:hover{background:#16a34a}
.btn.secondary{background:#0b1222;border:1px solid var(--border)}
.btn.secondary:hover{background:#1e293b}
.btn.warn{background:var(--warning);color:#1f1300}
.btn.warn:hover{background:#d97706}
.btn.danger{background:var(--danger)}
.btn.danger:hover{background:#dc2626}
.table{width:100%;border-collapse:separate;border-spacing:0;overflow:auto}
.table th,.table td{
  padding:10px 8px;border-bottom:1px solid var(--border);
  text-align:left;font-size:14px
}
.table th{color:var(--muted);font-weight:600}
.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px}
.badge.s1{background:#0b3b1d;color:#86efac;border:1px solid #14532d}
.badge.s2{background:#132a46;color:#93c5fd;border:1px solid #1e3a8a}
.muted{color:var(--muted)}
.right{display:flex;justify-content:flex-end}
.nowrap{white-space:nowrap}
.footer{margin-top:18px;font-size:12px;color:var(--muted);text-align:center}
.chip{
  background:#0b1222;border:1px solid var(--border);
  padding:6px 12px;border-radius:999px;font-size:13px
}
.filters{display:flex;gap:8px;flex-wrap:wrap}
@media (max-width:800px){
  .row{grid-template-columns:1fr}
  .col-3,.col-4,.col-6,.col-8,.col-12{grid-column:span 1}
}
.action-bar {
  margin-top: 32px;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding-top: 20px;
  border-top: 1px dashed var(--border);
}
#lokasiInfo {
  position: fixed;
  top: 10px;
  right: 10px;
  background: var(--card);
  padding: 6px 12px;
  border-radius: 12px;
  font-size: 13px;
  border: 1px solid var(--border);
}

/* ==== LOGO & NAMA PERUSAHAAN ==== */
/* ==== FONT OVIDIUS SCRIPT ==== */
@font-face {
  font-family: 'Ovidius Script';
  src: url('OvidiusScript.ttf') format('truetype');
  font-display: swap;
}

#headerLogo {
  position: fixed;
  top: 10px;
  left: 10px;
  display: flex;
  align-items: center;
  gap: 12px; /* jarak antara logo dan teks */
  z-index: 9999;
  background: rgba(15,23,42,0.4); /* transparan elegan */
  padding: 6px 12px;
  border-radius: 10px;
  backdrop-filter: blur(6px);
}

#logoPerusahaan {
  height: 150px;
  width: auto;
  border-radius: 8px;
  background: white;
  padding: 4px;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
  transition: height 0.3s ease;
}

#namaPerusahaan {
  font-family: 'Ovidius Script', cursive;
  font-size: 30px;
  color: #f5f5f5;
  text-shadow:
    0 0 4px rgba(255, 255, 255, 0.25),
    0 0 8px rgba(180, 220, 255, 0.25);
}




/* ==== Responsif ==== */
@media (max-width: 768px) {
  #logoPerusahaan { height: 65px; }
  #namaPerusahaan { font-size: 16px; }
}

@media (max-width: 480px) {
  #logoPerusahaan { height: 50px; }
  #namaPerusahaan { font-size: 14px; }
}



input,select,button{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#0b1222;
  color:var(--text);
  transition:all .2s ease;
  font-size:16px;
}

/* ==== MODAL POPUP ==== */
#popupModal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  min-width: 250px;
  max-width: 90%;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.5);
  color: var(--text);
  padding: 20px;
  display: none;
  z-index: 9999;
  text-align: center;
}
#popupModal .icon {
  font-size: 36px;
  margin-bottom: 12px;
}
#popupModal .icon.success { color: #22c55e; }
#popupModal .icon.error { color: #ef4444; }
#popupModal .msg { font-size: 16px; margin-bottom: 12px; }
#popupModal .closeBtn {
  cursor: pointer;
  background: #1e293b;
  color: var(--text);
  border: none;
  padding: 6px 12px;
  border-radius: 8px;
  font-weight: 600;
  transition: all .2s ease;
}
#popupModal .closeBtn:hover { background: #111827; }

/* ==== POPUP KONFIRMASI MODERN ==== */
#popupConfirm {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(3px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9998;
  opacity: 0;
  transition: opacity 0.2s ease;
  pointer-events: none;
}
#popupConfirm.active { opacity: 1; pointer-events: auto; }
#popupConfirm .content {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  min-width: 250px;
  max-width: 90%;
  box-shadow: 0 8px 25px rgba(0,0,0,0.5);
}
#popupConfirm .content .actions {
  margin-top: 12px;
  display: flex;
  justify-content: center;
  gap: 10px;
}
</style>
</head>
<body>

<!-- üè¢ Logo & Nama Perusahaan -->
<div id="headerLogo">
  <img src="logo-harita-group.jpg" alt="Logo Harita Group" id="logoPerusahaan">
  <span id="namaPerusahaan"><span style="letter-spacing:3px;">PT&nbsp;</span> Kayong Aluminium Nusantara</span>
</div>


<div id="lokasiInfo">GPS: mencari...</div>
<div class="container grid">
<!-- FORM INPUT -->
<div class="card">
<h1>Form Daily Input Ritase</h1>
<h2>Waktu & lokasi tercatat otomatis</h2>
<div class="row">
<div class="col-4">
<label>Shift</label>
<div class="actions">
<button class="btn secondary" id="btnShift1" onclick="setShift(1)">Shift 1</button>
<button class="btn secondary" id="btnShift2" onclick="setShift(2)">Shift 2</button>
<span id="shiftNow" class="chip">Aktif: 1</span>
</div>
</div>
<div class="col-4">
<label>Tanggal (otomatis)</label>
<input id="tanggalNow" type="text" disabled />
</div>
<div class="col-4">
<label>Jam (otomatis)</label>
<input id="jamNow" type="text" disabled />
</div>
</div>

<!-- === TAMBAHAN CHECKER: pilih sekali, tersimpan === -->
<div class="row" style="margin-top:8px">
  <div class="col-4">
    <label>ID Checker</label>
    <select id="checkerId" onchange="setCheckerId(this.value)">
      <option value="">-- Pilih ID --</option>
      <option value="C01">C01</option>
      <option value="C02">C02</option>
      <option value="C03">C03</option>
      <option value="C04">C04</option>
      <option value="C05">C05</option>
      <option value="C06">C06</option>
      <option value="C07">C07</option>
      <option value="C08">C08</option>
      <option value="C09">C09</option>
      <option value="C10">C10</option>
    </select>
    <div class="chip" id="checkerNow">Belum dipilih</div>
  </div>
</div>
<!-- === /TAMBAHAN CHECKER === -->

<div class="row" style="margin-top:8px">
  <div class="col-4">
    <label>Loader</label>
    <div style="display:flex;gap:6px">
      <select id="loaderPrefix" style="width:100px">
        <option value="">--</option>
        <option value="AHG">AHG</option>
        <option value="AKS">AKS</option>
        <option value="BKM">BKM</option>
        <option value="BSS">BSS</option>
        <option value="HER">HER</option>
        <option value="KTU">KTU</option>
        <option value="LMP">LMP</option>
        <option value="PIK">PIK</option>
      </select>
      <input id="loaderNo" placeholder="001" style="flex:1" />
    </div>
  </div>
  <div class="col-4">
    <label>Hauler</label>
    <div style="display:flex;gap:6px">
      <select id="haulerPrefix" style="width:100px">
        <option value="">--</option>
        <option value="AHG">AHG</option>
        <option value="AKS">AKS</option>
        <option value="BKM">BKM</option>
        <option value="BSS">BSS</option>
        <option value="HER">HER</option>
        <option value="KTU">KTU</option>
        <option value="LMP">LMP</option>
        <option value="PIK">PIK</option>
      </select>
      <input id="haulerNo" placeholder="009" style="flex:1" />
    </div>
  </div>
  <div class="col-4">
    <label>Location Front</label>
    <select id="front">
      <option value="">-- Pilih Location --</option>
      <option value="Aluminium">Aluminium</option>
      <option value="Living Quarter">Living Quarter</option>
      <option value="Power Plant">Power Plant</option>
      <option value="Stone Crusher">Stone Crusher</option>
    </select>
  </div>
  <div class="col-4">
    <label>Dumpingan</label>
    <input id="dump" placeholder="cth: Disposal 2" />
  </div>
  <div class="col-4">
    <label>Material</label>
    <select id="material">
      <option value="">-- Pilih Material --</option>
      <option value="Soil (A)">Soil (A)</option>
      <option value="Biomas (B)">Biomas (B)</option>
      <option value="Rock (C)">Rock (C)</option>
      <option value="Unblast (A+C)">Unblast (A+C)</option>
      <option value="Sand (D)">Sand (D)</option>
    </select>
  </div>
  <div class="col-4">
    <label>Jumlah Bucket</label>
    <input id="bucket" type="number" min="0" step="1" placeholder="0" />
  </div>
</div>
<div class="actions" style="margin-top:12px">
<button class="btn primary" onclick="simpan()">Simpan (Enter)</button>
<button class="btn secondary" onclick="resetForm()">Reset</button>
</div>
</div>

<!-- DATA TERSIMPAN -->
<div class="card">
<div class="row" style="align-items:end">
<div class="col-8">
<h2>Data Tersimpan</h2>
<div class="filters">
<select id="filterShift" onchange="render()">
<option value="">Semua Shift</option>
<option value="1">Shift 1</option>
<option value="2">Shift 2</option>
</select>
<input type="date" id="filterDate" onchange="render()" />
<button class="btn secondary" onclick="clearFilter()">Bersihkan Filter</button>
</div>
</div>
<div class="col-4 right">
<div class="chip" id="totalInfo">0 data</div>
</div>
</div>
<div style="overflow:auto;margin-top:8px">
<table class="table" id="tbl">
<thead>
<tr>
<th class="nowrap">#</th>
<th class="nowrap">Tanggal</th>
<th class="nowrap">Jam</th>
<th>Shift</th>
<!-- === TAMBAHAN CHECKER: kolom tabel === -->
<th>Checker</th>
<!-- === /TAMBAHAN CHECKER === -->
<th>Loader</th>
<th>Hauler</th>
<th>Location Front</th>
<th>Dumpingan</th>
<th>Material</th>
<th class="nowrap">Jumlah Bucket</th>
<th>Latitude</th>
<th>Longitude</th>
<th>Aksi</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>
<div style="margin-top:24px" class="actions far">
<button class="btn warn" onclick="exportCSVFiltered()">Export CSV</button>
<button class="btn danger" onclick="hapusSemua()">Hapus Semua</button>
</div>
<div class="footer">Data disimpan di browser (localStorage). Bisa dipakai offline.</div>
</div>
</div>

<!-- POPUP MODAL -->
<div id="popupModal">
  <div class="icon" id="popupIcon">‚úÖ</div>
  <div class="msg" id="popupMsg">Data tersimpan!</div>
  <button class="closeBtn" onclick="closePopup()">Tutup</button>
</div>

<!-- POPUP KONFIRMASI MODERN -->
<div id="popupConfirm">
  <div class="content">
    <div class="msg" id="confirmMsg">Apakah yakin ingin menghapus data ini?</div>
    <div class="actions">
      <button class="btn danger" id="confirmYes">Hapus</button>
      <button class="btn secondary" id="confirmNo">Batal</button>
    </div>
  </div>
</div>

<script>
// ==== SEMUA JS DI GABUNG DAN DIBENAHI URUTANNYA ====

// ==== UTILITAS WAKTU ====
const pad = n => String(n).padStart(2,'0');
function getTanggal(d=new Date()){return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;}
function getJam(d=new Date()){return `${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;}

// ==== STATE ====
let SHIFT_AKTIF=1;
const KEY='produksi_data_v2';
let lokasiTerakhir={lat:null,lon:null};
const KEY_CHECKER='CHECKER_ID';

// ==== SHIFT ====
function setShift(n){
  SHIFT_AKTIF=(n===2)?2:1;
  document.getElementById('shiftNow').textContent=`Aktif: ${SHIFT_AKTIF}`;
  document.getElementById('btnShift1').style.outline=SHIFT_AKTIF===1?'2px solid var(--accent)':'none';
  document.getElementById('btnShift2').style.outline=SHIFT_AKTIF===2?'2px solid var(--accent)':'none';
  focusFirst();
}

// ==== CLOCK REALTIME ====
function tick(){
  const now=new Date();
  document.getElementById('tanggalNow').value=getTanggal(now);
  document.getElementById('jamNow').value=getJam(now);
}
setInterval(tick,1000);tick();

// ==== STORAGE ====
function load(){try{return JSON.parse(localStorage.getItem(KEY))||[];}catch{return[];}}
function save(arr){localStorage.setItem(KEY,JSON.stringify(arr));}

// ==== FORM ====
function focusFirst(){document.getElementById('loaderPrefix').focus();}
function getForm(){
  const now = new Date();
  const shiftInfo = getShiftAndTanggalKerja(); // ‚Üê ambil shift & tanggal kerja yang sudah dihitung

  const loader=(document.getElementById('loaderPrefix').value ? document.getElementById('loaderPrefix').value+'-' : '') + document.getElementById('loaderNo').value.trim();
  const hauler=(document.getElementById('haulerPrefix').value ? document.getElementById('haulerPrefix').value+'-' : '') + document.getElementById('haulerNo').value.trim();
  return {
    tanggal: shiftInfo.tanggal, // üî• ini diganti dari getTanggal(now)
    jam: getJam(now),
    shift: shiftInfo.shift,
    checker:localStorage.getItem(KEY_CHECKER)||'',
    loader,hauler,
    front:document.getElementById('front').value,
    dump:document.getElementById('dump').value.trim(),
    material:document.getElementById('material').value.trim(),
    bucket:Number(document.getElementById('bucket').value||0),
    lat:lokasiTerakhir.lat, lon:lokasiTerakhir.lon
  };
}
function valid(d){
  if(!d.loader)return'Loader wajib diisi';
  if(!d.hauler)return'Hauler wajib diisi';
  if(!d.front)return'Location Front wajib dipilih';
  if(isNaN(d.bucket)||d.bucket<0)return'Jumlah Bucket tidak valid';
  return'';
}
function resetForm(){
  ['loaderPrefix','loaderNo','haulerPrefix','haulerNo','front','dump','material','bucket'].forEach(id=>{
    if(id==='front'||id==='material')document.getElementById(id).selectedIndex=0;
    else document.getElementById(id).value='';
  });
  focusFirst();
}

// ==== POPUP UTAMA ====
function showPopup(msg,type='success'){
  const modal=document.getElementById('popupModal');
  const icon=document.getElementById('popupIcon');
  const msgEl=document.getElementById('popupMsg');
  msgEl.textContent=msg;
  if(type==='success'){icon.textContent='‚úÖ';icon.className='icon success';}
  else{icon.textContent='‚ùå';icon.className='icon error';}
  modal.style.display='block';
}
function closePopup(){document.getElementById('popupModal').style.display='none';}

// ==== POPUP KONFIRM ====
let confirmCallback=null;
function showConfirm(msg,cb){
  confirmCallback=cb;
  document.getElementById('confirmMsg').textContent=msg;
  document.getElementById('popupConfirm').classList.add('active');
}
function closeConfirm(){
  document.getElementById('popupConfirm').classList.remove('active');
  setTimeout(()=>{confirmCallback=null;},200);
}
document.getElementById('confirmYes').onclick=()=>{if(confirmCallback)confirmCallback(true);closeConfirm();}
document.getElementById('confirmNo').onclick=()=>{if(confirmCallback)confirmCallback(false);closeConfirm();}

// ==== PENENTUAN SHIFT & TANGGAL KERJA OTOMATIS ====
function getShiftAndTanggalKerja() {
  const now = new Date();
  const jam = now.getHours();
  const tanggalKerja = new Date(now);

  let shift;
  if (jam >= 6 && jam < 18) {
    // Shift 1: 06.00‚Äì17.59, tanggal sama
    shift = 1;
  } else {
    // Shift 2: 18.00‚Äì05.59
    shift = 2;
    if (jam >= 0 && jam < 6) {
      // Jam 00:00‚Äì05:59 ‚Üí tanggal kerja harus mundur 1 hari
      tanggalKerja.setDate(tanggalKerja.getDate() - 1);
    }
  }

  const yyyy = tanggalKerja.getFullYear();
  const mm = String(tanggalKerja.getMonth() + 1).padStart(2, '0');
  const dd = String(tanggalKerja.getDate()).padStart(2, '0');

  return {
    shift,
    tanggal: `${yyyy}-${mm}-${dd}`
  };
}


// ==== SIMPAN DATA ====
function simpan(){
  const d=getForm();const err=valid(d);
  if(err){showPopup(err,'error');return;}
  const arr=load();arr.push(d);save(arr);
  resetForm();render();
  showPopup('Data tersimpan!','success');
}
document.addEventListener('keydown',e=>{
  if(e.key==='Enter'&&(document.activeElement.tagName==='INPUT'||document.activeElement.tagName==='SELECT')){
    e.preventDefault();simpan();
  }
});

// ==== TABEL ====
function escapeHtml(s){return String(s).replace(/[&<>"]/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[c]));}
function render(){
  const tbody=document.getElementById('tbody');tbody.innerHTML='';
  const arr=load();
  const fs=document.getElementById('filterShift').value;
  const fd=document.getElementById('filterDate').value;
  let data=arr;
  if(fs)data=data.filter(x=>String(x.shift)===String(fs));
  if(fd)data=data.filter(x=>x.tanggal===fd);
  document.getElementById('totalInfo').textContent=`${data.length} data`;
  data.forEach((r,idx)=>{
    const tr=document.createElement('tr');
    const badge=`<span class="badge ${r.shift==1?'s1':'s2'}">${r.shift==1?'Shift 1':'Shift 2'}</span>`;
    tr.innerHTML=`<td>${idx+1}</td><td>${r.tanggal}</td><td>${r.jam}</td><td>${badge}</td>
    <td>${escapeHtml(r.checker||'')}</td><td>${escapeHtml(r.loader)}</td>
    <td>${escapeHtml(r.hauler)}</td><td>${escapeHtml(r.front)}</td>
    <td>${escapeHtml(r.dump)}</td><td>${escapeHtml(r.material)}</td>
    <td>${Number(r.bucket)||0}</td>
    <td>${r.lat?r.lat.toFixed(5):'-'}</td><td>${r.lon?r.lon.toFixed(5):'-'}</td>
    <td><button class="btn danger" onclick="hapusModern(${idx},this)">Hapus</button></td>`;
    tbody.appendChild(tr);
  });
}
function clearFilter(){document.getElementById('filterShift').value='';document.getElementById('filterDate').value='';render();}

// ==== HAPUS ====
function hapusModern(i,btn){
  showConfirm('Apakah yakin ingin menghapus baris ini?',ok=>{
    if(ok){
      const arr=load();arr.splice(i,1);save(arr);
      if(btn){
        const tr=btn.closest('tr');
        tr.style.opacity='0';tr.style.transform='translateX(-30px)';
        setTimeout(()=>{render();showPopup('Data berhasil dihapus!','success');},300);
      }else{render();showPopup('Data berhasil dihapus!','success');}
    }
  });
}
function hapusSemua(){
  showConfirm('Apakah yakin ingin menghapus semua data?',ok=>{
    if(ok){save([]);render();showPopup('Semua data berhasil dihapus!','success');}
  });
}

// ==== EXPORT CSV ====
function exportCSVFiltered(){
  const arr=load();
  if(!arr.length){showPopup('Belum ada data.','error');return;}
  const fs=document.getElementById('filterShift').value;
  const fd=document.getElementById('filterDate').value;
  let data=arr;
  if(fs)data=data.filter(x=>String(x.shift)===String(fs));
  if(fd)data=data.filter(x=>x.tanggal===fd);
  if(!data.length){showPopup('Data sesuai filter kosong.','error');return;}
  const header=['Tanggal','Jam','Shift','Checker','Loader','Hauler','Location Front','Dumpingan','Material','Jumlah Bucket','Latitude','Longitude'];
  const rows=data.map(r=>[r.tanggal,r.jam,r.shift,(r.checker||''),r.loader,r.hauler,r.front,r.dump,r.material,r.bucket,r.lat,r.lon]);
  const csv=[header,...rows].map(cols=>cols.map(v=>`"${String(v??'').replaceAll('"','""')}"`).join(',')).join('\n');
  const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');a.href=url;a.download=`produksi_${Date.now()}.csv`;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(url);
  showPopup('Data berhasil diexport!','success');
}

// ==== CHECKER ====
function setCheckerId(id){
  if(!id)return;
  localStorage.setItem(KEY_CHECKER,id);
  document.getElementById('checkerNow').textContent="Aktif: "+id;
}

function autoShiftUpdate() {
  const info = getShiftAndTanggalKerja();
  SHIFT_AKTIF = info.shift;

  // Update tampilan label shift
  const shiftNow = document.getElementById('shiftNow');
  if (shiftNow) shiftNow.textContent = `Aktif: ${SHIFT_AKTIF}`;

  // Ubah warna tombol sesuai shift aktif
  const btn1 = document.getElementById('btnShift1');
  const btn2 = document.getElementById('btnShift2');
  if (btn1 && btn2) {
    btn1.style.outline = SHIFT_AKTIF === 1 ? '2px solid var(--accent)' : 'none';
    btn2.style.outline = SHIFT_AKTIF === 2 ? '2px solid var(--accent)' : 'none';
  }

  // Nonaktifkan tombol agar tidak bisa diubah manual
  if (btn1) btn1.disabled = true;
  if (btn2) btn2.disabled = true;

  // Update tanggal kerja otomatis
  const tanggalEl = document.getElementById('tanggalNow');
  if (tanggalEl) tanggalEl.value = info.tanggal;
}


// ==== INIT ====
autoShiftUpdate();
setInterval(autoShiftUpdate, 60000); // update tiap 1 menit

render();
(function initChecker(){
  const saved=localStorage.getItem(KEY_CHECKER);
  if(saved){
    document.getElementById('checkerId').value=saved;
    document.getElementById('checkerNow').textContent="Aktif: "+saved;
  }
})();

// ==== GPS ====
if("geolocation"in navigator){
  navigator.geolocation.watchPosition(
    pos=>{
      lokasiTerakhir.lat=pos.coords.latitude;
      lokasiTerakhir.lon=pos.coords.longitude;
      document.getElementById("lokasiInfo").textContent=`GPS: ${lokasiTerakhir.lat.toFixed(5)}, ${lokasiTerakhir.lon.toFixed(5)}`;
    },
    err=>{document.getElementById("lokasiInfo").textContent="GPS Error: "+err.message;},
    {enableHighAccuracy:true,maximumAge:0,timeout:15000}
  );
}else{
  document.getElementById("lokasiInfo").textContent="GPS tidak tersedia";
}
</script>



</script>

</body>
</html>
